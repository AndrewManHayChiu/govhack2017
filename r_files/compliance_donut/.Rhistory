add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "orange"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "red")) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "light gray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "black"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "black"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "black"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "orange"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "red")) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "red", size = 2)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "red", size = 4)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "red", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
p <- ggplot(aust, aes(x = Year, y = Gini)) +
geom_line(colour = "red", size = 1) +
geom_line(data = usa, colour = "dark grey") +
geom_line(data = uk, colour = "dark grey") +
geom_line(data = hk, colour = "grey") +
geom_line(data = china, colour = "grey") +
geom_line(data = denmark, colour = "light grey") +
geom_line(data = norway, colour = "light grey") +
geom_line(data = sweden, colour = "light grey") +
geom_line(data = finland, colour = "light grey") +
theme_minimal() +
labs(title = "Income Inequality (Gini Coefficient) - Selected countries")
p
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "grey"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "gray87"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "ivory"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "gray7"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "ivory"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "gray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "ivory"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "mintyrose"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "lightblue"))  %>%
layout(title = "Income Inequality")
plot_ly(data = aust, x = Year, y = Gini, name = "Australia", type = "scatter", mode = "lines", line = list(color = "orange", width = 3)) %>%
add_trace(data = usa, x = Year, y = Gini, name = "USA", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = uk, x = Year, y = Gini, name = "UK", type = "scatter", mode = "lines", line = list(color = "lightgray"))  %>%
add_trace(data = denmark, x = Year, y = Gini, name = "Denmark", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = norway, x = Year, y = Gini, name = "Norway", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = sweden, x = Year, y = Gini, name = "Sweden", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = finland, x = Year, y = Gini, name = "Finland", type = "scatter", mode = "lines", line = list(color = "darkgray"))  %>%
add_trace(data = hk, x = Year, y = Gini, name = "Hong Kong", type = "scatter", mode = "lines", line = list(color = "lightblue"))  %>%
add_trace(data = china, x = Year, y = Gini, name = "China", type = "scatter", mode = "lines", line = list(color = "lightblue"))  %>%
add_trace(data = korea, x = Year, y = Gini, name = "Korea", type = "scatter", mode = "lines", line = list(color = "lightblue"))  %>%
add_trace(data = japan, x = Year, y = Gini, name = "Japan", type = "scatter", mode = "lines", line = list(color = "lightblue"))  %>%
layout(title = "Income Inequality")
combi
library(rmarkdown)
install.packages("rmarkdown")
install.packages("rmarkdown")
install.packages("readr")
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(data.table)
setwd("C:\Users\Chiu Man Hay\Documents\Instacart Market Basket Analysis")
setwd("C:/Users/Chiu Man Hay/Documents/Instacart Market Basket Analysis")
aisles <- read_csv(unz("aisles.csv.zip", "aisles.csv"))
## Set working directory to location of data files
setwd("C:/Users/Chiu Man Hay/Documents/Instacart Market Basket Analysis")
aisles <- read_csv(unz("aisles.csv.zip", "aisles.csv"))
install.packages("flexdashboard")
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F)
## Set working directory to location of data files
setwd("C:/Users/Chiu Man Hay/Documents/Instacart Market Basket Analysis")
## Load files after unzipping them
aisles <- read_csv(unz("aisles.csv.zip", "aisles.csv"))
departments <- read_csv(unz("departments.csv.zip", "departments.csv"))
orders <- read_csv(unz("orders.csv.zip", "orders.csv"))
products <- read_csv(unz("products.csv.zip", "products.csv"))
order_products_prior <- read_csv(unz("order_products_prior.csv.zip",
"order_products_prior.csv"))
aisles
class(aisles)
aisels[aisle_id, ]
aisels[aisle_id == 1, ]
install.packages("backport")
install.packages("backports")
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
dim(aisles)
dim(aisles)
dim(departments)
dim(orders)
dim(products)
dim(order_products_prior)
order_products_train <- read_csv(unz("order_products__train.csv.zip",
"order_products__train.csv"))
unz("order_products__train.csv.zip",
"order_products__train.csv")
knitr::opts_chunk$set(echo = FALSE, message = F, warning = F, cache = T)
library(data.table)
library(readr)
# library(tidyverse)    # includes readr
library(ggplot2)
library(gridExtra)
library(scales)
## Set working directory to location of data files
setwd("C:/Users/Chiu Man Hay/Documents/Instacart Market Basket Analysis")
## Load files after unzipping them
orders <- read_csv(unz("orders.csv.zip", "orders.csv"))
orders <- data.table(orders)
orders
knitr::opts_chunk$set(echo = TRUE, message = F, warning = F, cache = T)
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp
temp <- spread(temp, key = order_number, value = order_hour_of_day)
library(data.table)
library(readr)
library(tidyr)
# library(tidyverse)    # includes readr
library(ggplot2)
library(scales)
library(gridExtra)
temp <- spread(temp, key = order_number, value = order_hour_of_day)
temp
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp
?kmeans
kmeans <- kmeans(temp, centers = 5)
kmeans <- kmeans(temp, centers = 5, na.omit())
kmeans <- kmeans(temp, centers = 5, na.omit(NA))
kmeans <- kmeans(temp, centers = 5, na.omit = T)
kmeans <- kmeans(temp, centers = 5, na.rm = T)
temp
temp <- temp[, .(-1)]
temp
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp <- temp[, .(user_id, 2, 3)]
temp
kmeans <- kmeans(temp, centers = 5)
kmeans
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp <- temp[, .(user_id, "2", "3")]
temp
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp
str(temp)
temp$2
temp[, 2:3]
temp[2:3, ]
temp[2:3, 2]
?data.table
temp
temp[, 2]
temp[2, ]
temp[2, ]
temp[2, 1]
temp[2, 2, with = F]
temp[, 2, with = F]
temp[, 3, with = F]
temp <- temp[, .(user_id, 2, 3), with = FALSE]
temp
temp <- temp[, .(user_id, "2", "3"), with = FALSE]
temp <- temp[, .("user_id", "2", "3"), with = FALSE]
temp <- temp[, 3:4, with = FALSE]
temp
kmeans <- kmeans(temp, centers = 5)
kmeans
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp <- temp[, 3:5, with = FALSE]
kmeans <- kmeans(temp, centers = 5)
kmeans
temp2 <- temp[, 3:10, with = FALSE]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp <- orders[, .(user_id, order_number, days_since_prior_order)]
temp <- spread(temp, key = order_number, value = days_since_prior_order)
temp2 <- temp[, 3:10, with = FALSE]
kmeans <- kmeans(temp2, centers = 5)
temp2 <- temp[, 3:6, with = FALSE]
kmeans <- kmeans(temp2, centers = 5)
temp2 <- temp[, 3:5, with = FALSE]
kmeans <- kmeans(temp2, centers = 5)
length(kmeans)
length(kmeans$cluster)
nrow(orders)
nrow(temp)
cluster <- data.frame(user_id = temp$user_id,
cluster = kmeans$cluster)
cluster
cluster <- data.table(cluster)
orders <- cluster[orders, on = user_id]
orders <- cluster[orders, by = user_id]
cluster
orders
orders <- cluster[orders, on = "user_id"]
orders
ggplot(orders[user_id %in% sample,], aes(x = order_number, y = days_since_prior_order)) +
geom_point(fill = cluster) +
geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = cluster)) +
geom_point() +
geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
ggplot(orders[user_id %in% sample,], aes(x = order_number, y = days_since_prior_order)) +
geom_point() +
geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
set.seed(20170527)
sample <- sample(unique(orders$user_id), 200)
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = cluster)) +
geom_point() +
geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = as.factor(cluster))) +
geom_point() +
geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = as.factor(cluster))) +
geom_point() +
# geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
orders
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = as.factor(cluster))) +
# geom_point() +
geom_jitter() +
# geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently order more")
ggplot(orders[user_id %in% sample,], aes(x = order_number,
y = days_since_prior_order,
colour = as.factor(cluster))) +
# geom_point() +
geom_jitter() +
# geom_smooth() +
theme_minimal() +
theme(axis.ticks.x = element_blank(),
axis.ticks.y = element_blank(),
# legend.position = "none",
panel.grid.major = element_blank(),
panel.grid.minor = element_blank()) +
labs(x = "Order Number",
y = "Days Since Prior Order",
title = "Days since prior order") +
annotate("text", x = 85, y = 10,
label = "People who order frequently have more orders")
temp2 <- temp[, 3:10, with = FALSE]
kmeans <- kmeans(na.omit(temp2), centers = 5)
kmeans
cluster <- data.frame(user_id = temp$user_id,
cluster = kmeans$cluster)
cluster <- data.frame(user_id = temp$user_id,
cluster = kmeans$cluster)
cluster <- data.frame(user_id = temp$user_id,
cluster = kmeans$cluster)
length*temp$user_id)
length(temp$user_id)
length(kmeans$cluster)
temp
library(rsconnect)
rsconnect::setAccountInfo(name='chiumanhay',
token='23E50333D072FD52B5EED2A51A361D96',
secret='<SECRET>')
rsconnect::setAccountInfo(name='chiumanhay',
token='23E50333D072FD52B5EED2A51A361D96',
secret='3hD7sQtSscMaDMsEV543VeaQXkejUcGNiacFT/RC')
library(RForecastio)
library(Rforecastio)
install.packages("Rforecastio")
library(Rforecastio)      # forecast weather data
library(weatherr)
install.packages("weatherr")
install.packages("darksky")
library(darksky)
library(leaflet)          # Map
install.packages('leaflet')
library(shiny)
library(shinydashboard)
library(dplyr)            # Data manipulation
library(ggplot2)          # Visualisations
library(plotly)           # Visualisations - interactive
library(leaflet)          # Map
library(darksky)
library(lubridate)        # Manipulate date variables
library(plotly)           # Another interactive graphics library
library(weatherr)      # Get weather forecast data
library(plotly)
install.packages("tibble")
install.packages("tibble")
library(plotly)
library(tibble)
install.packages("tibble")
library(tibble)
library(plotly)
library(dplyr)
df <- data.frame(comp = c("Complete", "Incomplete"),
value = c(.2, .8))
plot_ly(df,
labels = ~comp,
values = ~value) %>%
add_pie(hole = 0.5) %>%
layout(title = "Regulatory Compliance",
showlegend = F,
xaxis = list(showgrid = F, zeroline = F, showticklabels = F),
yaxis = list(showgrid = F, zeroline = F, showticklabels = F))
plot_ly(df,
labels = ~comp,
values = ~value) %>%
add_pie(hole = 0.6) %>%
layout(title = "Regulatory Compliance",
showlegend = F,
xaxis = list(showgrid = F, zeroline = F, showticklabels = F),
yaxis = list(showgrid = F, zeroline = F, showticklabels = F))
plot_ly(df,
labels = ~comp,
values = ~value) %>%
add_pie(hole = 0.6) %>%
layout(title = "AML/CTF Compliance",
showlegend = F,
xaxis = list(showgrid = F, zeroline = F, showticklabels = F),
yaxis = list(showgrid = F, zeroline = F, showticklabels = F))
df <- data.frame(comp = c("Complete", "Incomplete"),
value = c(40/200), 160/200))
plot_ly(df,
labels = ~comp,
values = ~value) %>%
add_pie(hole = 0.6) %>%
layout(title = "AML/CTF Compliance",
showlegend = F,
xaxis = list(showgrid = F, zeroline = F, showticklabels = F),
yaxis = list(showgrid = F, zeroline = F, showticklabels = F))
df <- data.frame(comp = c("Complete", "Incomplete"),
value = c(40/200, 160/200))
plot_ly(df,
labels = ~comp,
values = ~value) %>%
add_pie(hole = 0.6) %>%
layout(title = "AML/CTF Compliance",
showlegend = F,
xaxis = list(showgrid = F, zeroline = F, showticklabels = F),
yaxis = list(showgrid = F, zeroline = F, showticklabels = F))
shiny::runApp('GitHub/govhack2017/r_files/radioButtonTest2')
